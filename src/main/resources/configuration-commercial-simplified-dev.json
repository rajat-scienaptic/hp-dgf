{
  "config": "commercial",
  "sparkConfig": {
    "master": "local[*]",
    "appName": "hp-commercial-simplified"
  },
  "sources": {
    "IEC_CLAIMS": {
      "name": "iec_claims",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\iec claims archive.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"n",
          "cols": ["Big Deal ID","Deal Description","Business Model Description","Partner Desc","Partner Ship Calendar Date","Product ID","Claim Quantity","Claim Partner Unit Rebate"]
        }
      }
    },
    "XS_CLAIMS": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\03_Xs_Claims.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"n",
          "cols": ["Deal ID","Deal Description","Business Model Description","Claim Partner Name","Partner Ship Calendar Date","Manufacturing Product Identifier","Claim Quantity","Claim Partner Unit Rebate USD"]
        },
        "SELECT_AFTER_START_END_DATE_FILTER": {
          "isUnknown": "y",
          "cols": ["Start Date","End Date","Start - Week End","Week End - End","Season_Ordered","New End Date","Max_Week_End_Date","End Date Change"]
        }
      },
      "rename": {
        "RENAME_INITIAL_SELECT": {
          "Deal ID": "Big Deal ID",
          "Claim Partner Name": "Partner Desc",
          "Manufacturing Product Identifier": "Product ID",
          "Claim Partner Unit Rebate USD": "Claim Partner Unit Rebate"
        }
      },
      "join": {
        "CLAIMS_AND_ACCOUNTS": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Partner Desc"],
            "right": ["Account Company"]
          },
          "selectCriteria": {
            "left": [], "right": ["Account Company"]
          }
        },
        "CLAIMS_AND_MASTER_CALENDAR": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Big Deal ID","Base SKU"],
            "right": ["C2B Promo Code","SKU"]
          },
          "selectCriteria": {
            "left": [], "right": ["SKU"]
          }
        },
        "CLAIMS_AND_WED": {
          "isUnknown": "y",
          "typeOfJoin": ["inner"],
          "joinCriteria": {
            "left": ["Week End Date"],
            "right": ["Week_End_Date"]
          },
          "selectCriteria": {
            "left": ["Start Date","End Date"], "right": ["fy_week","Week_End_Date"]
          }
        },
        "CLAIMS_AND_SKU_HIER": {
          "isUnknown": "n",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Base SKU"],
            "right": ["SKU"]
          },
          "selectCriteria": {
            "left": ["Account Consol","Grouping","Reseller Cluster","VPA","Week End Date","Big Deal ID","Base SKU","Claim Partner Unit Rebate","Sum_Claim Quantity","Partner Ship Calendar Date","Program","Total Amount","season","Season_Ordered","Cal_Month","Cal_Year","Fiscal_Qtr","Fiscal_Year","Promo Name"],
            "right": ["SKU","Street Price","Consol SKU","Abbreviated Name","Full Name","Platform Name","Brand","IPSLES","HPS/OPS","Series","Category","Category Subgroup","Category_1","Category_2","Category_3","Line","PL","Mono/Color","Category Custom"]
          }
        },
        "CLAIMS_OUTSIDE_PROMO_Y_AND_N": {
          "isUnknown": "n",
          "typeOfJoin": ["inner"],
          "joinCriteria": {
            "left": ["Base SKU","C2B Promo Code"],
            "right": ["Right_Base SKU","Right_C2B Promo Code"]
          },
          "selectCriteria": {
            "left": ["Week End Date","Base SKU","Claim Partner Unit Rebate","C2B Promo Code","Sum_Sum_Claim Quantity"],
            "right": ["Avg_Sum_Sum_Claim Quantity"]
          }
        },
        "CLAIMS_AND_MASTER_CALENDAR_AFTER_AGGREGATION": {
          "isUnknown": "y",
          "typeOfJoin": ["inner","leftanti"],
          "joinCriteria": {
            "left": ["SKU","C2B Promo Code"],
            "right": ["Base SKU","Right_C2B Promo Code"]
          },
          "selectCriteria": {
            "left": [],
            "right": ["Base SKU","Right_C2B Promo Code"]
          }
        }
      },
      "group":{
        "GROUP_SKU_ACCOUNT_SUM_CLAIM_QUANT": {
          "cols" : ["Account Consol","Grouping","Reseller Cluster","VPA","Week End Date","Big Deal ID","Base SKU","Claim Partner Unit Rebate","Partner Ship Calendar Date"],
          "aggregations": {"sum":{"Claim Quantity":"Sum_Claim Quantity"}},
          "selectCriteria": []
        },
        "RESELLER_WED_SKU_PROGRAM_AGG_CLAIM_REBATE_QUANTITY": {
          "cols" : ["Reseller Cluster","Week End Date","Consol SKU","Program"],
          "aggregations": {"sum":{"Sum_Claim Quantity":"Sum_Sum_Claim Quantity"},
                           "max":{"Claim Partner Unit Rebate": "Claim Partner Unit Rebate"}},
          "selectCriteria": []
        },
        "RESELLER_WED_SKU_PROGRAM_AGG_CLAIM_QUANTITY": {
          "cols" : ["Reseller Cluster","Week End Date","Consol SKU","Program"],
          "aggregations": {"sum":{"Sum_Sum_Claim Quantity":"Sum_Sum_Claim Quantity"}},
          "selectCriteria": []
        },
        "WED_SKU_C2B_PROMO_CODE_SUM_CLAIM_QUANTITY": {
          "cols" : ["Week End Date","Base SKU","C2B Promo Code"],
          "aggregations": {"sum":{"Sum_Claim Quantity":"Sum_Sum_Claim Quantity"}},
          "selectCriteria": []
        },
        "SKU_PROMO_CODE_AVG_CLAIM_QUANTITY": {
          "cols" : ["Base SKU","C2B Promo Code"],
          "aggregations": {"avg":{"Sum_Sum_Claim Quantity":"Avg_Sum_Sum_Claim Quantity"}},
          "selectCriteria": []
        },
        "WED_SKU_CLAIM_REBATE_PROMO_CODE_SUM_CLAIM_QUANTITY": {
          "cols" : ["Week End Date","Base SKU","Claim Partner Unit Rebate","C2B Promo Code"],
          "aggregations": {"sum":{"Sum_Claim Quantity":"Sum_Sum_Claim Quantity"}},
          "selectCriteria": []
        },
        "PROMO_CODE_SKU_MAX_WED": {
          "cols" : ["C2B Promo Code","Base SKU"],
          "aggregations": {"max":{"Week End Date":"Max_Week_End_Date"}},
          "selectCriteria": []
        },
        "SKU_WED_PROMO_CODE_MAX_REBATE_AMOUNT": {
          "cols" : ["SKU","Week_End_Date","C2B Promo Code"],
          "aggregations": {"max":{"Rebate Amount":"IR"}},
          "selectCriteria": []
        }
      },
      "filter": {
        "FILTER_PROGRAM_EQ_BID_DEAL": {
          "multiWordMap": {},
          "conditionTypes": ["and"],
          "conditions": ["Program = Big.Deal"]
        },
        "FILTER_PROGRAM_EQ_PROMO_OPTION_C": {
          "multiWordMap": {},
          "conditionTypes": ["and"],
          "conditions": ["Program = Promo.Option.C"]
        },
        "FILTER_OUTSIDE_PROMO_DATE_EQ_N": {
          "multiWordMap": {"out_prom_date": "Outside Promo Date"},
          "conditionTypes": ["and"],
          "conditions": ["out_prom_date = N"]
        },
        "FILTER_OUTSIDE_PROMO_DATE_EQ_Y": {
          "multiWordMap": {"out_prom_date": "Outside Promo Date"},
          "conditionTypes": ["and"],
          "conditions": ["out_prom_date = Y"]
        },
        "FILTER_INCLUDE_EQ_Y": {
          "multiWordMap": {},
          "conditionTypes": ["and"],
          "conditions": ["Include = Y"]
        },
        "OPTION_TYPE_NOT_EQUALS_OPTION_C": {
          "multiWordMap": {"opt_type": "Option Type", "opt_c": "Option C"},
          "conditionTypes": ["and"],
          "conditions": ["opt_type != opt_c"]
        }
      },
      "sort": {
        "ASC_SKU_WED_DESC_REBATE": {
          "asc": ["SKU","Week_End_Date"],
          "desc": ["Rebate Amount"]
        }
      }
    },
    "RAW_MASTER_CALENDAR" :{
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\master_calendar_raw_commercial.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"Y",
          "cols": []
        },
        "DISTINCT_SELECT": {
          "isUnknown": "n",
          "cols": ["C2B Promo Code","Promo Name","SKU","Start Date","End Date"]

        },
        "SELECT_FOR_DISTINCT": {
          "isUnknown": "n",
          "cols": ["C2B Promo Code","Promo Name"]
        }
      }
    },
    "WEEK_END_DATE": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\AUX_week_end_date.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"n",
          "cols": ["fy_week","wed","season","season_ordered","cal_month","cal_year","fiscal_quarter","fiscal_year"]
        }
      },
      "rename": {
        "RENAME_INITIAL_SELECT": {
          "wed": "Week_End_Date",
          "season_ordered": "Season_Ordered",
          "cal_month": "Cal_Month",
          "cal_year": "Cal_Year",
          "fiscal_quarter": "Fiscal_Qtr",
          "fiscal_year": "Fiscal_Year"
        }
      }
    },
    "SKU_HIERARCHY": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\AUX_sku_hierarchy.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"n",
          "cols": ["SKU","Street Price","Consol SKU","Abbreviated Name","Full Name","Platform Name","Brand","IPSLES","HPS/OPS","Series","Category","Category Subgroup","Category_1","Category_2","Category_3","Line","PL","Mono/Color","Category Custom","L1: Use Case","L2: Key functionality","PLC Status","GA date","ES date"]
        }
      }
    },
    "COMM_ACCOUNTS": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\comm_accounts.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"n",
          "cols": ["Account Company","Account Consol","Grouping","Reseller Cluster","VPA"]
        }
      }
    },
    "ONYX_ST": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\US Comm ST-STT.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"Y",
          "cols": ["eTailers Grp ID"]
        },
        "SELECT_BEFORE_OUTPUT": {
          "isUnknown": "Y",
          "cols": ["eTailers", "Claimed Big Deal Qty", "Big Deal Claim Difference", "Option C IR","Claimed Option C Qty", "Option C Qty Adj"]
        }
      },
      "join": {
        "ST_ONYX_AND_AUX_ACCOUNTS": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Account Company"],
            "right": ["Right_Account Company"]
          },
          "selectCriteria": {
            "left": [], "right": ["Right_Account Company"]
          }
        },
        "ST_ONYX_AND_SKU_HIERARCHY": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Product Base ID"],
            "right": ["Right_SKU"]
          },
          "selectCriteria": {
            "left": [], "right": ["Right_SKU","Full Name"]
          }
        },
        "ST_ONYX_AND_WED": {
          "isUnknown": "y",
          "typeOfJoin": ["inner"],
          "joinCriteria": {
            "left": ["Week"],
            "right": ["fy_week"]
          },
          "selectCriteria": {
            "left": ["Quarter","Month","Week","Week Desc","Account Company","Account HQ","Account Major","Flag Direct","Product Base Desc","Product Category Desc","Product Base ID"],
            "right": ["fy_week"]
          }
        },
        "ST_ONYX_AND_PROMO_ID":{
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Deal ID 1"],
            "right": ["C2B Promo Code"]
          },
          "selectCriteria": {
            "left": [],
            "right": ["C2B Promo Code"]
          }
        },
        "ST_ONYX_AND_CLAIMS_AGGREGATED": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Reseller Cluster","SKU","Week_End_Date"],
            "right": ["Right_Reseller Cluster","Consol SKU","Week End Date"]
          },
          "selectCriteria": {
            "left": [],
            "right": ["Right_Reseller Cluster","Week End Date","Consol SKU","Program"]
          }
        },
        "ST_ONYX_OPTION_C_JOIN": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Reseller Cluster","SKU","Week_End_Date"],
            "right": ["Right_Reseller Cluster","Consol SKU","Week End Date"]
          },
          "selectCriteria": {
            "left": [],
            "right": ["Right_Reseller Cluster","Week End Date","Consol SKU","Program"]
          }
        },
        "ST_ONYX_PROMO_JOIN": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["SKU","Week_End_Date"],
            "right": ["Right_SKU","Right_Week_End_Date"]
          },
          "selectCriteria": {
            "left": [],
            "right": ["Right_SKU","Right_Week_End_Date"]
          }
        },
        "ST_ONYX_MERGE_INVENTORY": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["SKU","Reseller Cluster","Week_End_Date"],
            "right": ["Right_SKU","Right_Reseller Cluster","Right_Week_End_Date"]
          },
          "selectCriteria": {
            "left": [],
            "right": ["Right_SKU","Right_Reseller Cluster","Right_Week_End_Date"]
          }
        }
      },
      "group": {
        "PRODUCT_BASE_SUM_AGG_SELL_THRU_SELL_TO_QTY": {
          "cols" : ["Product Base ID","Product Base Desc"],
          "aggregations": {"sum":{"Sell-Thru Qty":"Sum_Sell-Thru Qty", "Sell-To Qty":"Sum_Sell-To Qty"}},
          "selectCriteria": []
        },
        "DEAL_ETAILERS_ACCOUNT_SEASON_CAL_SKU_FISCAL_SUM_AGG_SELL_THRU_TO_QTY": {
          "cols" : ["Deal ID 1","eTailers","Account Consol","Grouping","VPA","Reseller Cluster","Street Price","SKU","Platform Name","Brand","IPSLES","HPS/OPS","Series","Category","Category Subgroup","Category_1","Category_2","Category_3","Line","PL","Mono/Color","Category Custom","L1: Use Case","L2: Key functionality","PLC Status","GA date","ES date","Week_End_Date","season","Season_Ordered","Cal_Month","Cal_Year","Fiscal_Qtr","Fiscal_Year","SKU_Name"],
          "aggregations": {"sum":{"Sell-Thru Qty":"STT Qty", "Sell-To Qty":"ST Qty"}},
          "selectCriteria": []
        },
        "GROUP_ALL_SUM_AGG_BIG_NON_BIG_DEAL_QTY": {
          "cols": ["Account Consol","Grouping","VPA","Reseller Cluster","eTailers","Street Price","SKU","Platform Name","Brand","IPSLES","HPS/OPS","Series","Category","Category Subgroup","Category_1","Category_2","Category_3","Line","PL","Mono/Color","Category Custom","L1: Use Case","L2: Key functionality","PLC Status","GA date","ES date","Week_End_Date","season","Season_Ordered","Cal_Month","Cal_Year","Fiscal_Qtr","Fiscal_Year","SKU_Name","Promo"],
          "aggregations": {"sum": {"Big Deal Qty": "Big_Deal_Qty", "Non Big Deal Qty": "Non_Big_Deal_Qty", "Qty": "Qty"}},
          "selectCriteria": []
        },
        "GROUP_ALL_EXCEPT_ACCOUNT_GROUPING_PROMO_SUM_AGG_QTY_AND_DEAL_QTS": {
          "cols": ["Reseller Cluster","VPA","eTailers","Street Price","SKU","Platform Name","Brand","IPSLES","HPS/OPS","Series","Category","Category Subgroup","Category_1","Category_2","Category_3","Line","PL","Mono/Color","Category Custom","L1: Use Case","L2: Key functionality","PLC Status","GA date","ES date","Week_End_Date","Season","Season_Ordered","Cal_Month","Cal_Year","Fiscal_Qtr","Fiscal_Year","SKU_Name"],
          "aggregations": {"sum": {"Big_Deal_Qty":"Big_Deal_Qty", "Non_Big_Deal_Qty": "Non_Big_Deal_Qty", "Qty":"Qty"}},
          "selectCriteria": []
        }
      },
      "sort": {
        "DESC_SELL_THRU_SELL_TO": {
          "asc": [],
          "desc": ["Sum_Sell-Thru Qty","Sum_Sell-To Qty"]
        }
      },
      "filter": {
        "FILTER_ETAILERS_NOT_EQ_Y": {
          "multiWordMap": {},
          "conditionTypes": ["and"],
          "conditions": ["eTailers != Y"]
        },
        "FILTER_ETAILERS_EQ_Y": {
          "multiWordMap": {},
          "conditionTypes": ["and"],
          "conditions": ["eTailers = Y"]
        },
        "FILTER_OPTION_C_QTY_ADJ_GR_0": {
          "multiWordMap": {"opt_c_qty_adj":"Option C Qty Adj"},
          "conditionTypes": ["and"],
          "conditions": ["opt_c_qty_adj > 0"]
        }
      }
    },
    "ONYX_STT": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\US Comm CI v1.csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"Y",
          "cols": ["eTailers Grp ID","Sell-Thru Qty","Sell-To Qty"]
        }
      },
      "join": {
        "STT_ONYX_AND_AUX_ACCOUNTS": {
          "isUnknown": "y",
          "typeOfJoin": ["leftanti","inner"],
          "joinCriteria": {
            "left": ["Account Company"],
            "right": ["Right_Account Company"]
          },
          "selectCriteria": {
            "left": [], "right": ["Right_Account Company","Account Consol","Grouping","VPA"]
          }
        },
        "STT_ONYX_AND_SKU_HIERARCHY": {
          "isUnknown": "y",
          "typeOfJoin": ["inner"],
          "joinCriteria": {
            "left": ["Product Base ID"],
            "right": ["Join_SKU"]
          },
          "selectCriteria": {
            "left": ["Quarter","Month","Week Desc","Account Company","Account HQ","Account Major","Flag Direct","Product Base Desc","Product Base ID"],
            "right": ["Join_SKU","Street Price","Abbreviated Name","Full Name","Platform Name","Brand","IPSLES","HPS/OPS","Series","Category","Category Subgroup","Category_1","Category_2","Category_3","Line","PL","Mono/Color","Category Custom","L1: Use Case","L2: Key functionality","PLC Status","GA date","ES date"]
          }
        },
        "STT_ONYX_AND_WED_MERGE_WED": {
          "isUnknown": "y",
          "typeOfJoin": ["inner"],
          "joinCriteria": {
            "left": ["Week"],
            "right": ["fy_week"]
          },
          "selectCriteria": {
            "left": ["Week"],
            "right": ["fy_week","season","Season_Ordered","Cal_Month","Cal_Year","Fiscal_Qtr","Fiscal_Year"]
          }
        }
      },
      "group": {
        "RESELLER_SKU_WED_SUM_AGG_INVENTORY_TOTAL": {
          "cols" : ["Reseller Cluster","SKU","Week_End_Date"],
          "aggregations": {"sum":{"Inventory Total Qty":"Inv_Qty"}},
          "selectCriteria": []
        }
      }
    },
    "TIDY_HPS_2016_17_HISTORICAL_POS": {
      "name": "",
      "filePath": "E:\\Scienaptic\\HP\\Pricing\\Data\\Commercial_Alteryx\\Tidy HPS prt 2016-2017_v2 (historical pos units).csv",
      "select": {
        "INITIAL_SELECT": {
          "isUnknown":"n",
          "cols": ["Account","Account Consol","Channel","Inv : Saleable Qty","Sales : Net Qty","season","HP_SKU_Short","season_ordered","cal_month","cal_year","fiscal_quarter","fiscal_year","wed"]
        }
      },
      "rename": {
        "RENAME_INITIAL_SELECT": {
          "Account": "Reseller",
          "Account Consol": "Reseller_Cluster",
          "Inv : Saleable Qty": "Inv_Qty_Raw",
          "Sales : Net Qty": "Qty",
          "season": "Season"
        },
        "RENAME_SEASON_CAL_FISCAL_AFTER_GROUP":{
          "season_ordered": "Season_Ordered",
          "cal_month": "Cal_Month",
          "cal_year": "Cal_Year",
          "fiscal_quarter": "Fiscal_Qtr",
          "fiscal_year": "Fiscal_Year"
        }
      },
      "filter": {
        "FILTER_CHANNEL_EQ_COMMERCIAL": {
          "multiWordMap": {},
          "conditionTypes": ["and"],
          "conditions": ["Channel = Commercial"]
        }
      },
      "group": {
        "SKU_SHORT_RESELLER_WED_SEASON_CAL_FISCAL_SUM_QUANT": {
          "cols" : ["HP_SKU_Short","Reseller_Cluster","Week_End_Date","Season","season_ordered","cal_month","cal_year","fiscal_quarter","fiscal_year"],
          "aggregations": {"sum":{"Qty":"Sum_Qty", "Inv_Qty_Raw":"Inv_Qty"}},
          "selectCriteria": []
        }
      },
      "join": {
        "TIDY_HIST_AND_SKU_HIER": {
          "isUnknown": "y",
          "typeOfJoin": ["inner"],
          "joinCriteria": {
            "left": ["HP_SKU_Short"],
            "right": ["SKU"]
          },
          "selectCriteria": {
            "left": ["HP_SKU_Short","Sum_Qty"],
            "right": ["SKU","Full Name","Platform Name"]
          }
        }
      }
    }
  }
}